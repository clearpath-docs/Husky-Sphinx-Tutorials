



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Husky UR5 Mobile Manipulation Demo (Simulation) &mdash; Husky UGV Tutorials 0.5.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/clearpath.css" type="text/css" />
  

  
    <link rel="top" title="Husky UGV Tutorials 0.5.1 documentation" href="index.html"/>
        <link rel="next" title="Husky Dual UR5 Mobile Manipulation Demo (Simulation)" href="HuskyDualManip.html"/>
        <link rel="prev" title="Husky Outdoor GPS Waypoint Navigation" href="HuskyGPSWaypointNav.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Start of clearpathrobotics Zendesk Widget script -->
<script>/*<![CDATA[​*/window.zEmbed||function(e,t){var n,o,d,i,s,a=[],r=document.createElement("iframe");window.zEmbed=function(){a.push(arguments)},window.zE=window.zE||window.zEmbed,r.src="javascript:false",r.title="",r.role="presentation",(r.frameElement||r).style.cssText="display: none",d=document.getElementsByTagName("script"),d=d[d.length-1],d.parentNode.insertBefore(r,d),i=r.contentWindow,s=i.document;try{o=s}catch(c){n=document.domain,r.src='javascript:var d=document.open();d.domain="'+n+'";void(0);',o=s}o.open()._l=function(){var o=this.createElement("script");n&&(this.domain=n),o.id="js-iframe-async",o.src=e,this.t=+new Date,this.zendeskHost=t,this.zEQueue=a,this.body.appendChild(o)},o.write('<body onload="document._l();">'),o.close()}("https://assets.zendesk.com/embeddable_framework/main.js","clearpathrobotics.zendesk.com");/*​]]>*/</script>
<!-- End of clearpathrobotics Zendesk Widget script -->

<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

 ga('create', 'UA-65409991-1', 'auto');
 ga('send', 'pageview');

</script>


</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Husky UGV Tutorials
          

          
            
            <img src="_static/clearpathlogo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.5.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="BackUpHusky.html">Backing Up Husky Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="InstallHuskySoftware.html">Install and Configure Husky Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="CustomizeHuskyConfig.html">Customize Husky Configuration</a></li>
</ul>
<p class="caption"><span class="caption-text">Using Husky</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="SimulatingHusky.html">Simulating Husky</a></li>
<li class="toctree-l1"><a class="reference internal" href="InterfacingWithHusky.html">Interfacing with Husky</a></li>
</ul>
<p class="caption"><span class="caption-text">Demo Applications: Navigation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="HuskyMove.html">Husky Move Base Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="HuskyAMCL.html">Husky AMCL Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="HuskyGmapping.html">Husky Gmapping Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="HuskyFrontiers.html">Husky Frontier Exploration Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="HuskyGPSWaypointNav.html">Husky Outdoor GPS Waypoint Navigation</a></li>
</ul>
<p class="caption"><span class="caption-text">Demo Applications: Manipulation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">Husky UR5 Mobile Manipulation Demo (Simulation)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bring-up-gazebo-and-the-husky">Bring up Gazebo And The Husky</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stow-the-arm-to-home-position">Stow the arm to home position</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bring-up-moveit-rviz">Bring Up MoveIt &amp; RViz</a></li>
<li class="toctree-l2"><a class="reference internal" href="#moving-the-husky">Moving The Husky</a></li>
<li class="toctree-l2"><a class="reference internal" href="#moving-the-husky-s-arm">Moving The Husky&#8217;s Arm</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="HuskyDualManip.html">Husky Dual UR5 Mobile Manipulation Demo (Simulation)</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Components</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="HuskyPackages.html">Husky Packages</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Husky UGV Tutorials</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
     
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="http://support.clearpathrobotics.com">Home</a> &raquo;</li>
      
    <li>Husky UR5 Mobile Manipulation Demo (Simulation)</li>
      <li class="wy-breadcrumbs-aside">
        <div class="roslogo">
      </div>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="husky-ur5-mobile-manipulation-demo-simulation">
<h1>Husky UR5 Mobile Manipulation Demo (Simulation)<a class="headerlink" href="#husky-ur5-mobile-manipulation-demo-simulation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This tutorial assumes you have ROS Indigo installed, Gazebo, RViz, and a computer that is strong enough to handle simulations and inverse kinematics. If you wish to work with the real Clearpath Robotics Husky UR5, please see www.clearpathrobotics.com.</p>
</div>
<img alt="_images/Selection_016.png" src="_images/Selection_016.png" />
<p>The Husky UR5 mobile manipulation tutorial will show you how to operate a mobile manipulation robot using Gazebo, RViz, <a class="reference external" href="http://wiki.ros.org/MoveIt">MoveIt</a>, and the UR5 arm. There will be full control and actuation of the robot, and the software written for this robot can be easily translated into real world actions with the real Husky UR5 robot by Clearpath Robotics.</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Make sure you have the husky_simulator packages and husky_ur5_moveit_config packages installed.This tutorial also assumes you have ROS, Gazebo, and RViz installed on your system.</p>
<div class="code bash highlight-python"><div class="highlight"><pre>sudo apt-get install ros-indigo-husky-simulator &amp;&amp; sudo apt-get install ros-indigo-husky-ur5-moveit-config
</pre></div>
</div>
<p>If users wish to use the free-planning mode vs joint-limited mode (As of April 1st the universal_robot package used to plan hasn&#8217;t been updated in debs and so source must be used), please install the source package for universal_robot and use it to ovveride the deb installed.</p>
<p>In addition, make sure you have the most updated packages of ros_control &amp; universal_robot debs on your machine. (If you get an error about the hardwareInterface and joints being missing, you will need to change your control_ur5.yaml file inside husky_control. Please download the husky source package. This was broken and fixed as of May 16, 2015 but still hasn&#8217;t been released to the public Indigo debs.)</p>
<div class="code bash highlight-python"><div class="highlight"><pre>mkdir -p devel_ws/src &amp;&amp; cd devel_ws/src &amp;&amp; catkin_init_workspace
</pre></div>
</div>
<div class="code bash highlight-python"><div class="highlight"><pre>git clone https://github.com/ros-industrial/universal_robot &amp;&amp; cd ..
</pre></div>
</div>
<div class="code bash highlight-python"><div class="highlight"><pre>catkin_make install
</pre></div>
</div>
<p>Before running each command in this tutorial, run this command or add it to your ~/.bashrc file:</p>
<div class="code bash highlight-python"><div class="highlight"><pre>source ~/devel_ws/devel/setup.bash
</pre></div>
</div>
</div>
<div class="section" id="bring-up-gazebo-and-the-husky">
<h2>Bring up Gazebo And The Husky<a class="headerlink" href="#bring-up-gazebo-and-the-husky" title="Permalink to this headline">¶</a></h2>
<p>Running the launch file which will bring up Gazebo with the Husky + UR5.</p>
<div class="code bash highlight-python"><div class="highlight"><pre>roslaunch husky_gazebo husky_playpen.launch ur5_enabled:=true
</pre></div>
</div>
<p>which will look like this: (note the gripper release hasn&#8217;t been pushed into debs so it will not have the gripper)</p>
<img alt="_images/spawnedbotgz.png" src="_images/spawnedbotgz.png" />
</div>
<div class="section" id="stow-the-arm-to-home-position">
<h2>Stow the arm to home position<a class="headerlink" href="#stow-the-arm-to-home-position" title="Permalink to this headline">¶</a></h2>
<p>If the arm spawns out in front, likely the stow was disabled for safety reasons. Run the stow script to home the arm, which will move it in the Gazebo simulation.</p>
<div class="code bash highlight-python"><div class="highlight"><pre>rosrun husky_control stow_ur5
</pre></div>
</div>
</div>
<div class="section" id="bring-up-moveit-rviz">
<h2>Bring Up MoveIt &amp; RViz<a class="headerlink" href="#bring-up-moveit-rviz" title="Permalink to this headline">¶</a></h2>
<p>To do so:</p>
<div class="code bash highlight-python"><div class="highlight"><pre>roslaunch husky_ur5_moveit_config husky_ur5_planning_execution.launch sim:=true
</pre></div>
</div>
<div class="code bash highlight-python"><div class="highlight"><pre>roslaunch husky_ur5_moveit_config moveit_rviz.launch config:=true
</pre></div>
</div>
<p>Which will bring up a screen that has the Husky like this:</p>
<img alt="_images/spawnedbot.png" src="_images/spawnedbot.png" />
</div>
<div class="section" id="moving-the-husky">
<h2>Moving The Husky<a class="headerlink" href="#moving-the-husky" title="Permalink to this headline">¶</a></h2>
<p>Bring up the interactive marker server:</p>
<div class="code bash highlight-python"><div class="highlight"><pre>rosrun interactive_marker_twist_server marker_server
</pre></div>
</div>
<p>And make sure to add the interactive marker plugin to RViz by clicking &#8220;Add&#8221; and then finding interactive markers. Be sure to set the topic to the correct one as well, or else you won&#8217;t be able to move the Husky base around with them.</p>
<p>Interfacing with the robot is super simple! See the markers in the scene? Just click on them to move the robot around. The blue marker will control its turning.</p>
<img alt="_images/bluegrabber.png" src="_images/bluegrabber.png" />
<p>And the red marker will control its forward and backward motion.</p>
<img alt="_images/redgrabber.png" src="_images/redgrabber.png" />
</div>
<div class="section" id="moving-the-husky-s-arm">
<h2>Moving The Husky&#8217;s Arm<a class="headerlink" href="#moving-the-husky-s-arm" title="Permalink to this headline">¶</a></h2>
<p>After playing with the Husky&#8217;s movement capabilities, now we can look at how to move its arm. On the left hand side of RViz, you will see a panel that looks like this. Make sure &#8220;Planning&#8221; is selected.</p>
<img alt="_images/planningtabrviz.png" src="_images/planningtabrviz.png" />
<p>Now click and drag the end effector in RViz which will highlight when your mouse is over it:</p>
<img alt="_images/gripperorb.png" src="_images/gripperorb.png" />
<p>There&#8217;s a lot going on in this next picture. I will explain. The orange arm is the goal position for the arm. Dragging the orb allows you to move the end effector to its desired position. A kinematic solver will move the orange arm around to satisfy the constraint of where you put the orb. The markers near the orb will allow you to precisely precision the orb to wherever you want it. The proper coloured arm is where the arm is currently positioned in the real world (but in this case, Gazebo simulation).</p>
<img alt="_images/armplanningrviz.png" src="_images/armplanningrviz.png" />
<p>Now, in the planning tab, press plan and execute. This will plan a path for the arm to take to move it to the orange goal state. Execute will interact with the controllers on the robot to move it to that position.</p>
<img alt="_images/pressplan.png" src="_images/pressplan.png" />
<p>Notice that the arm , after I had pressed plan and execute, has moved in simulation and in the visualization software.</p>
<img alt="_images/finalposerviz.png" src="_images/finalposerviz.png" />
<img alt="_images/finalposegz.png" src="_images/finalposegz.png" />
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="HuskyDualManip.html" class="btn btn-neutral float-right" title="Husky Dual UR5 Mobile Manipulation Demo (Simulation)" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="HuskyGPSWaypointNav.html" class="btn btn-neutral" title="Husky Outdoor GPS Waypoint Navigation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Clearpath Robotics.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.5.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>